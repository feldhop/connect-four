$(document).ready(function(){function a(a){var e=b(a);j%2==0&&j!==!1&&7>e?(c(e,a,"red"),h[e][a]=1,j+=1,d()):j%2!==0&&j!==!1&&7>e&&(c(e,a,"black"),h[e][a]=7,j+=1,d())}function b(a){for(var b=6;b>=0;b--)if(0===h[b][a])return b}function c(a,b,c){"red"===c?$("#chip-color").css("background-color","black"):$("#chip-color").css("background-color","red");var d=0,e=setInterval(function(){$('.slot[data-column="'+(b+1)+'"][data-row="'+d+'"]').css("background-color","white"),$('.slot[data-column="'+(b+1)+'"][data-row="'+(d+1)+'"]').css("background-color",c),d++,d>a&&clearInterval(e)},100)}function d(){for(var a=0;4>a;a++)for(var b=0;7>b;b++)if(4===k.checkWin.horz(b,a))e("red",k.markWin.horz(b,a));else if(28===k.checkWin.horz(b,a))e("black",k.markWin.horz(b,a));else if(j%2!==0&&21===k.checkWin.horz(b,a)){for(i=0;i<4;i++)if(0===h[b][a+i])return a+i}else if(j%2!==0&&3===k.checkWin.horz(b,a))for(i=0;i<4;i++)if(0===h[b][a+i])return a+i;for(var b=0;4>b;b++)for(var a=0;7>a;a++)if(4===k.checkWin.vert(b,a))e("red",k.markWin.vert(b,a));else if(28===k.checkWin.vert(b,a))e("black",k.markWin.vert(b,a));else if(j%2!==0&&21===k.checkWin.vert(b,a)){for(i=0;i<4;i++)if(0===h[b+i][a])return a}else if(j%2!==0&&3===k.checkWin.vert(b,a))for(i=0;i<4;i++)if(0===h[b+i][a])return a;for(var b=0;4>b;b++){for(var a=0;4>a;a++)4===k.checkWin.diagForw(b,a)?e("red",k.markWin.diagForw(b,a)):28===k.checkWin.diagForw(b,a)&&e("black",k.markWin.diagForw(b,a));for(var a=6;a>2;a--)4===k.checkWin.diagBack(b,a)?e("red",k.markWin.diagBack(b,a)):28===k.checkWin.diagBack(b,a)&&e("black",k.markWin.diagBack(b,a))}h[0][0]&&h[0][1]&&h[0][2]&&h[0][3]&&h[0][4]&&h[0][5]&&h[0][6]>0&&(alert("DRAW!"),confirm("Would you like to play again?")&&g())}function e(a,b){for(j=!1,$('#winner>h2[data-winner="'+a+'"]').show(),$("#winner").show(),i=0;i<4;i++)$('.slot[data-row="'+(b[i][0]+1)+'"][data-column="'+(b[i][1]+1)+'"]').addClass("win-location")}function f(b){var c=d();if(j%2!==0&&void 0===c){if(0===b)var e=b+1,f=b;else if(6===b)var e=b,f=b-1;else var e=b+1,f=b-1;var g=Math.floor(Math.random()*(e-f+1))+f;setTimeout(function(){a(g)},1e3)}else setTimeout(function(){console.log("I meant to do that",c),a(c)},1e3)}function g(a){h=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]],j=0;for(var b=0;6>=b;b++)for(var c=0;6>=c;c++)$('.slot[data-column="'+(b+1)+'"][data-row="'+(c+1)+'"]').css("background-color","white");$("#chip-color").css("background-color","red"),$("#winner>h2").hide(),$("#winner").hide(),$(".win-location").removeClass("win-location")}var h=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]],j=0;const k={checkWin:{horz:function(a,b){return h[a][b]+h[a][b+1]+h[a][b+2]+h[a][b+3]},vert:function(a,b){return h[a][b]+h[a+1][b]+h[a+2][b]+h[a+3][b]},diagForw:function(a,b){return h[a][b]+h[a+1][b+1]+h[a+2][b+2]+h[a+3][b+3]},diagBack:function(a,b){return h[a][b]+h[a+1][b-1]+h[a+2][b-2]+h[a+3][b-3]}},markWin:{horz:function(a,b){return[[a,b],[a,b+1],[a,b+2],[a,b+3]]},vert:function(a,b){return[[a,b],[a+1,b],[a+2,b],[a+3,b]]},diagForw:function(a,b){return[[a,b],[a+1,b+1],[a+2,b+2],[a+3,b+3]]},diagBack:function(a,b){return[[a,b],[a+1,b-1],[a+2,b-2],[a+3,b-3]]}}};$(".slot").click(function(){var b=$(this).attr("data-column")-1;a(b),j!==!1&&f(b)}),$("button").click(function(){g()})});